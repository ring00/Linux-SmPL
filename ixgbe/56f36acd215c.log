BUILD:
[33mbase commit: 56f36acd215c^1
[0m[33mtarget commit: 56f36acd215c
[0m[33mchecking out base commit... [0m[33mok (1s)
[0m[33mformatting diff... [0m[33mok (1s)
[0m14 source file(s) touched in the old version
`-- drivers/net/ethernet/amd/xgbe/xgbe-drv.c
`-- drivers/net/ethernet/broadcom/bnx2x/bnx2x_cmn.c
`-- drivers/net/ethernet/broadcom/bnxt/bnxt.c
`-- drivers/net/ethernet/freescale/dpaa/dpaa_eth.c
`-- drivers/net/ethernet/intel/fm10k/fm10k_netdev.c
`-- drivers/net/ethernet/intel/i40e/i40e_main.c
`-- drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
`-- drivers/net/ethernet/mellanox/mlx4/en_netdev.c
`-- drivers/net/ethernet/mellanox/mlx5/core/en_main.c
`-- drivers/net/ethernet/sfc/falcon/tx.c
`-- drivers/net/ethernet/sfc/tx.c
`-- drivers/net/ethernet/ti/netcp_core.c
`-- include/linux/netdevice.h
`-- net/sched/sch_mqprio.c
14 source file(s) touched in the new version
`-- drivers/net/ethernet/amd/xgbe/xgbe-drv.c
`-- drivers/net/ethernet/broadcom/bnx2x/bnx2x_cmn.c
`-- drivers/net/ethernet/broadcom/bnxt/bnxt.c
`-- drivers/net/ethernet/freescale/dpaa/dpaa_eth.c
`-- drivers/net/ethernet/intel/fm10k/fm10k_netdev.c
`-- drivers/net/ethernet/intel/i40e/i40e_main.c
`-- drivers/net/ethernet/intel/ixgbe/ixgbe_main.c
`-- drivers/net/ethernet/mellanox/mlx4/en_netdev.c
`-- drivers/net/ethernet/mellanox/mlx5/core/en_main.c
`-- drivers/net/ethernet/sfc/falcon/tx.c
`-- drivers/net/ethernet/sfc/tx.c
`-- drivers/net/ethernet/ti/netcp_core.c
`-- include/linux/netdevice.h
`-- net/sched/sch_mqprio.c
[33mcompile base commit... [0m[33mok (46s)
[0m[33mapply [0m[33m56f36acd215c... [0m[33mok (46s)
[0m[33mcompile target commit... [0m[33mok (85s)
[0mPREPARE:
[33mcollect AST for functions: __fm10k_setup_tc@drivers_net_ethernet_intel_fm10k_fm10k_netdev.c,__mlx4_en_setup_tc@drivers_net_ethernet_mellanox_mlx4_en_netdev.c,mlx5e_ndo_setup_tc@drivers_net_ethernet_mellanox_mlx5_core_en_main.c,mqprio_init@net_sched_sch_mqprio.c,mqprio_destroy@net_sched_sch_mqprio.c,netcp_setup_tc@drivers_net_ethernet_ti_netcp_core.c,dpaa_setup_tc@drivers_net_ethernet_freescale_dpaa_dpaa_eth.c,ef4_setup_tc@drivers_net_ethernet_sfc_falcon_tx.c,bnxt_setup_tc@drivers_net_ethernet_broadcom_bnxt_bnxt.c,xgbe_setup_tc@drivers_net_ethernet_amd_xgbe_xgbe-drv.c,__bnx2x_setup_tc@drivers_net_ethernet_broadcom_bnx2x_bnx2x_cmn.c,__ixgbe_setup_tc@drivers_net_ethernet_intel_ixgbe_ixgbe_main.c,efx_setup_tc@drivers_net_ethernet_sfc_tx.c,__i40e_setup_tc@drivers_net_ethernet_intel_i40e_i40e_main.c
[0m[33mTransforming and linking bitcode files...
[0m[33m12s
[0mANALYZE:
COCCIGEN:
//# pattern-1, witnesses: 7
@@
typedef __be16;
identifier dev;
identifier fn;
identifier handle;
identifier proto;
identifier tc;
typedef u32;
@@
 int fn(struct net_device * dev, u32 handle, __be16 proto, struct tc_to_netdev * tc)
 {
     <...
- tc->tc
+ tc->mqprio->num_tc
     ...>
 }
//# pattern-16, witnesses: 2
@r0@
identifier i, fn;
@@
struct net_device_ops i = {
    .ndo_setup_tc = fn,
};
@@
typedef __be16;
identifier handle;
identifier net_dev;
identifier ntc;
identifier proto;
identifier r0.fn;
typedef u32;
@@
 int fn(struct net_device * net_dev, u32 handle, __be16 proto, struct tc_to_netdev * ntc)
 {
     <...
- num_tc = ntc->tc;
+ num_tc = ntc->mqprio->num_tc;
+ ntc->mqprio->hw = TC_MQPRIO_HW_OFFLOAD_TCS;
     ...>
 }
